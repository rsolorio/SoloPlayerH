<table *ngIf="model && model.playerList && model.playerList.current" class="sp-full-height sp-full-width sp-table sp-table-no-padding sp-table-support-overflow-ellipsis">
  <!-- Navbar -->
  <tr class="sp-tr-navbar">
    <!-- Collapse button -->
    <td class="sp-td-navbar-icon sp-text-xlarge-fixed" (click)="onCollapseClick()">
      <i
      class="mdi-chevron-down mdi sp-cursor-pointer"
      [ngStyle]="palette.secondary.cssColor"></i>
    </td>
    <!-- Middle content -->
    <td>
      <table class="sp-table sp-table-no-padding sp-full-width sp-full-height"><tr>
        <!-- Playlist name -->
        <td class="sp-text-overflow-ellipsis">
          <i
          class="mdi-playlist-music-outline mdi sp-text-xlarge-fixed sp-cursor-pointer"
          style="line-height: 40px;"
          [ngStyle]="palette.secondary.cssColor"></i>
          <span
          class="sp-text-large" style="line-height: 40px;vertical-align: top;"
          [ngStyle]="palette.primary.cssColor">&nbsp;{{model.playerList.name}}</span>
          <span
          class="sp-text-medium"
          style="line-height: 40px;float: right;"
          [ngStyle]="palette.primary.cssColor">{{model.playerList.current.sequence}}/{{model.playerList.items.length}}</span>
        </td>
      </tr></table>
    </td>
    <!-- Menu -->
    <td class="sp-td-navbar-icon sp-text-xlarge-fixed" [ngStyle]="palette.secondary.cssColor">
      <sp-icon-menu [items]="menuList" [context]="model.playerList.current.song"></sp-icon-menu>
    </td>
  </tr>
  <!-- Image / Playlist / Lyrics -->
  <tr>
    <td colspan="3" class="sp-td-img">
      <div class="sp-img-container sp-flex-center sp-full-height sp-full-width" spResizeObserver (spResized)="onImageContainerResized($event)">
        <!-- Image -->
        <img
        #picture
        *ngIf="image"
        [ngClass]="{ 'sp-invisible': imageControlsEnabled }"
        (click)="onImageClick($event)"
        (load)="onImageLoad()"
        [src]="image.src"
        [style.width.px]="imageSize.width"
        [style.height.px]="imageSize.height"
        class="sp-img">
        <!-- Canvas (for image controls) -->
        <!-- Note that we set the canvas size as well as the element size -->
        <canvas
        *ngIf="image"
        spEyeDropper
        [eyeDropperTableId]="'tableEyeDropper'"
        [eyeDropperHoverId]="'divHoverColor'"
        (eyeDropperColorSelected)="onColorSelected($event)"
        class="sp-img sp-cursor-eye"
        [ngClass]="{ 'sp-invisible': !imageControlsEnabled }"
        [width]="imageSize.width"
        [height]="imageSize.height"
        [style.width.px]="imageSize.width"
        [style.height.px]="imageSize.height"></canvas>
        <!-- Lyrics overlay (hack: one more pixel that solves the blurry text and aligns with the image) -->
        <div
        *ngIf="lyricsOverlayEnabled"
        (click)="toggleLyrics()"
        class="sp-img sp-bg-dim-black-mid"
        [style.width.%]="100"
        [style.height.px]="imageSize.height + 1">
          <sp-text-scroller
          (close)="lyricsOverlayEnabled = false"
          [text]="song.lyrics"
          [palette]="palette">
          </sp-text-scroller>
        </div>
      </div>
    </td>
  </tr>
  <!-- Song Info -->
  <tr class="sp-tr-song-info">
    <td colspan="3" class="sp-text-overflow-ellipsis" [attr.style]="getEllipsisColorVar()">
      <!-- Title and Song Count -->
      <i class="sp-text-xlarge mdi mdi-music" [ngStyle]="palette.secondary.cssColor"></i>
      <span
      class="sp-text-xlarge sp-text-bold"
      [ngStyle]="palette.primary.cssColor">&nbsp;{{song.name}}</span>
      <span
      *ngIf="song.playCount > 0"
      class="sp-text-medium sp-play-count"
      [ngStyle]="palette.secondary.cssColor">&nbsp;{{song.playCount}}</span>
      <br>
      <!-- Artist Name -->
      <i class="mdi-account mdi sp-text-large" [ngStyle]="palette.secondary.cssColor"></i>
      <span
      class="sp-text-large"
      [ngStyle]="palette.primary.cssColor">&nbsp;{{song.artistName}}</span>
      <!-- Artist Type -->
      <ng-container *ngIf="song.artistType">
        <span>&nbsp;&nbsp;</span>
        <i class="mdi-microphone mdi sp-text-large" [ngStyle]="palette.secondary.cssColor"></i>
        <span
        class="sp-text-large"
        [ngStyle]="palette.primary.cssColor">&nbsp;{{song.artistType}}</span>
      </ng-container>
      <br>
      <!-- Album -->
      <i class="mdi-album mdi sp-text-large " [ngStyle]="palette.secondary.cssColor"></i>
      <span
      class="sp-text-large"
      [ngStyle]="palette.primary.cssColor">&nbsp;{{song.albumName}}</span>
      <br>
      <!-- Year -->
      <ng-container *ngIf="song.releaseYear > 0">
        <i class="mdi-calendar mdi sp-text-medium" [ngStyle]="palette.secondary.cssColor"></i>
        <span
        class="sp-text-medium"
        [ngStyle]="palette.primary.cssColor">&nbsp;{{song.releaseYear}}&nbsp;&nbsp;</span>
      </ng-container>
      <!-- Genre -->
      <ng-container *ngIf="song.genre">
        <i class="mdi-tag mdi sp-text-medium" [ngStyle]="palette.secondary.cssColor"></i>
        <span
        class="sp-text-medium"
        [ngStyle]="palette.primary.cssColor">&nbsp;{{song.genre}}&nbsp;&nbsp;</span>
      </ng-container>
      <!-- File Info -->
      <ng-container *ngIf="fileInfoVisible">
        <i class="mdi-file-music mdi sp-text-medium" [ngStyle]="palette.secondary.cssColor"></i>
        <span
        class="sp-text-medium sp-text-capitalize"
        [ngStyle]="palette.primary.cssColor">&nbsp;{{getFileInfo()}}</span>
      </ng-container>
    </td>
  </tr>
  <!-- Footer -->
  <tr class="sp-tr-footer sp-player-overlay">
    <td colspan="3" class="sp-footer-outline">
      <!-- Song Controls -->
      <table *ngIf="!imageControlsEnabled" class="sp-table sp-table-no-padding sp-full-height sp-full-width">
        <!-- Song Toolbar -->
        <tr class="sp-tr-song-toolbar">
          <td colspan="3" class="sp-td-toolbar sp-full-width sp-text-big">
            <table class="sp-table sp-full-width">
              <tr>
                <!-- Link icon -->
                <td>
                  <i
                  (click)="toggleLive()"
                  class="mdi sp-cursor-pointer"
                  [ngClass]="song.live ? 'mdi-broadcast' : 'mdi-broadcast-off'"></i>
                </td>
                <!-- Lyrics icon -->
                <td>
                  <i
                  class="mdi sp-cursor-pointer"
                  (click)="toggleLyrics()"
                  [ngClass]="song.lyrics ? 'mdi-script-text-outline' : 'mdi-script-outline'"></i>
                </td>
                <!-- Rating icon -->
                <td>
                  <sp-rating
                  (change)="onRatingChange($event, song)"
                  [(ngModel)]="song.rating"
                  [classOff]="'sp-color-overlay-02'"
                  [classBack]="'sp-bg-dim-black-high'">
                  </sp-rating>
                </td>
                <!-- Mood icon -->
                <td>
                  <i
                  class="mdi sp-cursor-pointer"
                  (click)="onMoodClick(song)"
                  [ngClass]="song.mood && song.mood !== 'No Mood' ? 'mdi-emoticon-happy-outline' : 'mdi-emoticon-neutral-outline'"></i>
                </td>
                <!-- Favorite icon -->
                <td>
                  <i
                  class="mdi sp-cursor-pointer"
                  (click)="onFavoriteClick(song)"
                  [ngClass]="song.favorite ? 'mdi-heart' : 'mdi-heart-outline'"></i>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <!-- Time Slider -->
        <tr class="sp-tr-time-slider"><td colspan="3"><table class="sp-table"><tr>
          <!-- Elapsed -->
          <td class="sp-td-nav-bar-icon sp-text-xlarge sp-text-center sp-font-family-digital">
            <span [ngClass]="{ 'sp-fade-in-out': model.status === PlayerStatus.Paused }" class="sp-time-text">{{ model.elapsedSeconds | duration }}</span>
          </td>
          <!-- Progress Bar -->
          <td class="sp-td-progress-bar sp-full-width">
            <div class="sp-progress-back">
              <div class="sp-progress-front" [style.width.%]="model.elapsedPercentage"></div>
            </div>
          </td>
          <!-- Duration -->
          <td class="sp-td-nav-bar-icon sp-text-xlarge sp-text-center sp-font-family-digital">
              <span class="sp-time-text">{{ song.seconds | duration }}</span>
          </td>
        </tr></table></td></tr>
        <!-- Play Controls -->
        <tr class="sp-tr-play-controls">
          <td colspan="3">
            <table class="sp-full-width">
              <tr>
                <td class="sp-td-play-control sp-text-big-fixed">
                  <i *ngIf="model.playerList.play === PlayMode.Sequence" class="mdi-shuffle-disabled mdi"></i>
                  <i *ngIf="model.playerList.play === PlayMode.Random" class="mdi-shuffle mdi"></i>
                </td>
                <td class="sp-td-play-control sp-text-big-fixed">
                  <div (click)="onPrevious()" class="sp-player-button sp-back-forward">
                    <i class="mdi-skip-previous mdi sp-player-icon sp-back-forward"></i>
                  </div>
                </td>
                <td class="sp-td-play-control sp-text-huge-fixed">
                  <div (click)="onPlayPause()" class="sp-play-pause sp-player-button">
                      <i *ngIf="model.status !== PlayerStatus.Playing" class="mdi-play mdi sp-play-pause sp-player-icon"></i>
                      <i *ngIf="model.status === PlayerStatus.Playing" class="mdi-pause mdi sp-play-pause sp-player-icon"></i>
                  </div>
                </td>
                <td class="sp-td-play-control sp-text-big-fixed">
                  <div (click)="onForward()" class="sp-player-button sp-back-forward">
                    <i class="mdi-skip-next mdi sp-player-icon sp-back-forward"></i>
                  </div>
                </td>
                <td class="sp-td-play-control sp-text-big-fixed">
                  <i *ngIf="model.playerList.repeat === RepeatMode.All" class="mdi-repeat mdi"></i>
                  <i *ngIf="model.playerList.repeat === RepeatMode.One" class="mdi-repeat-once mdi"></i>
                  <i *ngIf="model.playerList.repeat === RepeatMode.Disabled" class="mdi-repeat-off mdi"></i>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
      <!-- Image Controls -->
      <table *ngIf="imageControlsEnabled" class="sp-table sp-full-height sp-full-width" style="table-layout: fixed;">
        <!-- Image Toolbar -->
        <tr class="sp-tr-image-toolbar">
          <td><i class="mdi-undo-variant mdi sp-text-big sp-cursor-pointer" (click)="onToolbarReset()"></i></td>
          <td><i class="mdi-chevron-left mdi sp-text-big sp-cursor-pointer" [ngClass]="{ 'sp-color-item-disabled': images.length < 2 }" (click)="onToolbarBack($event)"></i></td>
          <td><span *ngIf="image" class="sp-text-large">{{image.imageType.toUpperCase()}}</span></td>
          <td><i class="mdi-chevron-right mdi sp-text-big sp-cursor-pointer" [ngClass]="{ 'sp-color-item-disabled': images.length < 2 }" (click)="onToolbarNext($event)"></i></td>
          <td>
            <i *ngIf="!isLoadingPalette" (click)="onImageControlsClose($event)" class="mdi-close mdi sp-text-big sp-cursor-pointer"></i>
            <i *ngIf="isLoadingPalette" class="mdi-loading mdi-spin mdi sp-text-big"></i>
          </td>
        </tr>
        <!-- Colors -->
        <tr>
          <td colspan="5">
            <div class="sp-colors-container sp-full-height sp-full-width sp-text-xlarge">
              <!-- Eye Dropper -->
              <table id="tableEyeDropper" class="sp-table-eye-dropper sp-player-eye-dropper"></table>
              <div class="sp-full-height sp-full-width">
                <!-- Hover Color -->
                <div class="sp-color-bar" >
                  <i class="mdi-bullseye mdi sp-color-icon"></i>
                  <div id="divHoverColor" class="sp-full-height sp-full-width sp-color-bar-outline"></div>
                </div>
                <!-- Selected Color -->
                <div class="sp-color-bar">
                  <i class="mdi-cursor-default-click-outline mdi sp-color-icon"></i>
                  <div class="sp-full-height sp-full-width sp-color-bar-outline sp-clickable sp-ease-background-color-1" (click)="onSelectedColorClick()" [ngStyle]="colorSelected.cssBgColor"></div>
                </div>
                <!-- Palette -->
                <div class="sp-color-palette sp-color-bar">
                  <div class="sp-full-height sp-color-bar-small">
                    <i class="mdi-alpha-b-box-outline mdi sp-color-icon"></i>
                    <div
                    (click)="onBackgroundColorClick()"
                    class="sp-full-height sp-full-width sp-clickable sp-color-bar-outline sp-ease-background-color-1"
                    [ngStyle]="palette.background.cssBgColor"></div>
                  </div>
                  <div class="sp-full-height sp-color-bar-small">
                    <i class="mdi-numeric-1-box-outline mdi sp-color-icon"></i>
                    <div
                    (click)="onPrimaryColorClick()"
                    class="sp-full-height sp-full-width sp-clickable sp-color-bar-outline sp-ease-background-color-1"
                    [ngStyle]="palette.primary.cssBgColor"></div>
                  </div>
                  <div class="sp-full-height sp-color-bar-small">
                    <i class="mdi-numeric-2-box-outline mdi sp-color-icon"></i>
                    <div
                    (click)="onSecondaryColorClick()"
                    class="sp-full-height sp-full-width sp-clickable sp-color-bar-outline sp-ease-background-color-1"
                    [ngStyle]="palette.secondary.cssBgColor"></div>
                  </div>
                </div>
              </div>
            </div>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
